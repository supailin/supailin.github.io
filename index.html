<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TOEIC Vocabulary Master</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;family=Space+Grotesk:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Prompt', 'Space Grotesk', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); }
    .card-glass { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
    .btn-primary { background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%); }
    .btn-primary:hover { background: linear-gradient(135deg, #ff6b6b 0%, #e94560 100%); }
    .progress-bar { background: linear-gradient(90deg, #00d9ff, #00ff88); }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
    .animate-fade { animation: fadeIn 0.5s ease-out; }
    .animate-pulse-btn { animation: pulse 2s infinite; }
    .animate-slide { animation: slideIn 0.3s ease-out; }
    .day-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(233,69,96,0.2); }
    .word-card:hover { border-color: #e94560; }
    .option-btn { transition: all 0.2s ease; }
    .option-btn:hover { background: rgba(233,69,96,0.2); border-color: #e94560; }
    .option-btn.correct { background: rgba(0,255,136,0.3); border-color: #00ff88; }
    .option-btn.wrong { background: rgba(255,71,87,0.3); border-color: #ff4757; }
    .speaker-btn { transition: transform 0.2s; }
    .speaker-btn:hover { transform: scale(1.2); }
    .speaker-btn:active { transform: scale(0.9); }
  </style>
  <style>body { box-sizing: border-box; }</style>
 </head>
 <body class="h-full gradient-bg text-white overflow-auto">
  <div id="app" class="min-h-full w-full"><!-- Header -->
   <header class="sticky top-0 z-50 card-glass px-4 py-3">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
     <h1 id="main-title" class="text-xl md:text-2xl font-bold bg-gradient-to-r from-pink-500 to-yellow-500 bg-clip-text text-transparent">üìö TOEIC Vocabulary Master</h1>
     <div class="flex items-center gap-2"><span id="streak-display" class="text-sm bg-gradient-to-r from-green-400 to-blue-500 px-3 py-1 rounded-full"> üî• 0 ‡∏Ñ‡∏≥‡∏ñ‡∏π‡∏Å </span>
     </div>
    </div>
   </header><!-- Navigation Tabs -->
   <nav class="max-w-6xl mx-auto px-4 py-4">
    <div class="flex gap-2 overflow-x-auto pb-2"><button onclick="showView('home')" class="nav-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all bg-pink-500/20 border border-pink-500/50" data-view="home"> üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å </button> <button onclick="showView('learn')" class="nav-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all bg-white/10 border border-white/20" data-view="learn"> üìñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ </button> <button onclick="showView('quiz')" class="nav-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all bg-white/10 border border-white/20" data-view="quiz"> üìù ‡∏ó‡∏î‡∏™‡∏≠‡∏ö TOEIC </button> <button onclick="showView('stats')" class="nav-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all bg-white/10 border border-white/20" data-view="stats"> üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ </button>
    </div>
   </nav><!-- Main Content -->
   <main class="max-w-6xl mx-auto px-4 pb-8"><!-- Home View -->
    <div id="home-view" class="animate-fade">
     <div class="text-center mb-8">
      <h2 class="text-2xl md:text-3xl font-bold mb-2">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå TOEIC</h2>
      <p class="text-gray-400">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Day ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</p>
     </div>
     <div id="days-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"><!-- Days will be rendered here -->
     </div>
     <div class="mt-8 text-center"><button onclick="showView('quiz')" class="btn-primary px-8 py-4 rounded-2xl text-lg font-bold animate-pulse-btn shadow-lg shadow-pink-500/30"> üéØ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö TOEIC ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ </button>
     </div>
    </div><!-- Learn View -->
    <div id="learn-view" class="hidden animate-fade">
     <div class="flex items-center gap-4 mb-6"><button onclick="showView('home')" class="text-gray-400 hover:text-white transition-colors"> ‚Üê ‡∏Å‡∏•‡∏±‡∏ö </button>
      <h2 id="learn-title" class="text-xl font-bold">Day 1-2: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô (Prefix) ‡πÅ‡∏•‡∏∞ ‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞</h2>
     </div>
     <div id="words-list" class="space-y-4"><!-- Words will be rendered here -->
     </div>
    </div><!-- Quiz View -->
    <div id="quiz-view" class="hidden animate-fade">
     <div class="card-glass rounded-3xl p-6 md:p-8"><!-- Quiz Setup -->
      <div id="quiz-setup">
       <h2 class="text-2xl font-bold mb-6 text-center">üìù ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö TOEIC</h2>
       <div class="mb-6"><label class="block text-sm text-gray-400 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Day ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</label>
        <div id="quiz-day-selection" class="flex flex-wrap gap-2"><!-- Day checkboxes -->
        </div>
       </div>
       <div class="mb-6"><label class="block text-sm text-gray-400 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠:</label>
        <div class="flex gap-2"><button onclick="setQuizCount(10)" class="quiz-count-btn px-4 py-2 rounded-lg bg-pink-500/20 border border-pink-500">10 ‡∏Ç‡πâ‡∏≠</button> <button onclick="setQuizCount(20)" class="quiz-count-btn px-4 py-2 rounded-lg bg-white/10 border border-white/20">20 ‡∏Ç‡πâ‡∏≠</button> <button onclick="setQuizCount(30)" class="quiz-count-btn px-4 py-2 rounded-lg bg-white/10 border border-white/20">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        </div>
       </div><button onclick="startQuiz()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg"> üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö </button>
      </div><!-- Quiz Progress -->
      <div id="quiz-progress" class="hidden">
       <div class="flex justify-between items-center mb-4"><span id="quiz-counter" class="text-gray-400">‡∏Ç‡πâ‡∏≠ 1/10</span> <span id="quiz-score" class="text-green-400">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</span>
       </div>
       <div class="h-2 bg-white/10 rounded-full mb-6 overflow-hidden">
        <div id="quiz-progress-bar" class="progress-bar h-full rounded-full transition-all duration-300" style="width: 0%"></div>
       </div><!-- Question -->
       <div id="quiz-question" class="mb-6">
        <p class="text-lg md:text-xl mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</p>
        <p id="quiz-sentence" class="text-xl md:text-2xl font-medium p-4 bg-white/5 rounded-xl"></p>
       </div><!-- Options -->
       <div id="quiz-options" class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6"><!-- Options will be rendered here -->
       </div><!-- Feedback -->
       <div id="quiz-feedback" class="hidden p-4 rounded-xl mb-4">
        <p id="feedback-text" class="font-medium"></p>
        <p id="feedback-meaning" class="text-sm text-gray-400 mt-1"></p>
       </div><button id="next-question-btn" onclick="nextQuestion()" class="hidden w-full btn-primary py-3 rounded-xl font-bold"> ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí </button>
      </div><!-- Quiz Result -->
      <div id="quiz-result" class="hidden text-center">
       <div class="text-6xl mb-4">
        üéâ
       </div>
       <h3 class="text-2xl font-bold mb-2">‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!</h3>
       <p id="result-score" class="text-4xl font-bold text-green-400 mb-4">8/10</p>
       <p id="result-percentage" class="text-gray-400 mb-6">‡∏ó‡∏≥‡πÑ‡∏î‡πâ 80%</p>
       <div class="flex gap-4 justify-center"><button onclick="resetQuiz()" class="px-6 py-3 rounded-xl bg-white/10 border border-white/20 font-medium"> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà </button> <button onclick="showView('learn')" class="px-6 py-3 rounded-xl btn-primary font-medium"> ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå </button>
       </div>
      </div>
     </div>
    </div><!-- Stats View -->
    <div id="stats-view" class="hidden animate-fade">
     <h2 class="text-2xl font-bold mb-6">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</h2>
     <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <div class="card-glass rounded-2xl p-4 text-center">
       <div class="text-3xl font-bold text-green-400" id="stat-correct">
        0
       </div>
       <div class="text-sm text-gray-400">
        ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å
       </div>
      </div>
      <div class="card-glass rounded-2xl p-4 text-center">
       <div class="text-3xl font-bold text-red-400" id="stat-wrong">
        0
       </div>
       <div class="text-sm text-gray-400">
        ‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î
       </div>
      </div>
      <div class="card-glass rounded-2xl p-4 text-center">
       <div class="text-3xl font-bold text-blue-400" id="stat-total">
        0
       </div>
       <div class="text-sm text-gray-400">
        ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
       </div>
      </div>
      <div class="card-glass rounded-2xl p-4 text-center">
       <div class="text-3xl font-bold text-yellow-400" id="stat-accuracy">
        0%
       </div>
       <div class="text-sm text-gray-400">
        ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
       </div>
      </div>
     </div>
     <h3 class="text-lg font-bold mb-4">‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô</h3>
     <div id="weak-words" class="space-y-2">
      <p class="text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡∏π‡∏ô‡∏∞!</p>
     </div>
    </div>
   </main>
  </div>
  <script>
    // Vocabulary Data
    const vocabularyData = {
      "day1-2": {
        title: "Day 1-2: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô (Prefix) ‡πÅ‡∏•‡∏∞ ‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞",
        emoji: "üîÆ",
        color: "from-purple-500 to-pink-500",
        words: [
          { word: "Predict", thai: "‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢", example: "You can never predict what will happen next.", exampleThai: "‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ" },
          { word: "Prevent", thai: "‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô", example: "His disabilities prevent him from driving.", exampleThai: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Ç‡∏±‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏≤‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡πÑ‡∏î‡πâ" },
          { word: "Intend to", thai: "‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏à‡∏∞", example: "Miss Chambers intends to finish processing all accounts by tonight.", exampleThai: "‡∏Ñ‡∏∏‡∏ì Chambers ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏µ‡πâ" },
          { word: "Respond to", thai: "‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö", example: "New customer service personnel are trained to respond to inquiries.", exampleThai: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ù‡∏∂‡∏Å‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤" },
          { word: "Require", thai: "‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡πâ‡∏≠‡∏á/‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö", example: "The company requires all employees to wear identification badges.", exampleThai: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß" }
        ]
      },
      "day3": {
        title: "Day 3: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î",
        emoji: "üó£Ô∏è",
        color: "from-blue-500 to-cyan-500",
        words: [
          { word: "Inform", thai: "‡πÅ‡∏à‡πâ‡∏á/‡∏ö‡∏≠‡∏Å", example: "Please inform Benjamin of the changes.", exampleThai: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ö‡∏ô‡∏à‡∏≤‡∏°‡∏¥‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á" },
          { word: "Notify", thai: "‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏£‡∏≤‡∏ö", example: "We will notify you of any updates.", exampleThai: "‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÉ‡∏î‡πÜ" },
          { word: "Suggest", thai: "‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥", example: "The manager suggested that we store food items in a cool place.", exampleThai: "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏¢‡πá‡∏ô" },
          { word: "Introduce", thai: "‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏±‡∏ß", example: "I'd like to introduce you to the whole class.", exampleThai: "‡∏â‡∏±‡∏ô‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å" }
        ]
      },
      "day4": {
        title: "Day 4: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ß‡∏¥‡πÄ‡∏®‡∏©‡∏ì‡πå (-ly)",
        emoji: "‚ú®",
        color: "from-yellow-500 to-orange-500",
        words: [
          { word: "Equally", thai: "‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏°", example: "The resources were equally distributed.", exampleThai: "‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡∏Å‡∏±‡∏ô" },
          { word: "Frequently", thai: "‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á", example: "We frequently hold meetings.", exampleThai: "‡πÄ‡∏£‡∏≤‡∏à‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Å‡∏±‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á" },
          { word: "Extremely", thai: "‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å/‡∏™‡∏∏‡∏î‡πÜ", example: "This job may be extremely difficult.", exampleThai: "‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏¢‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡πÜ ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢" }
        ]
      },
      "day5": {
        title: "Day 5: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ -tain, -pose, -form, -sure",
        emoji: "üéØ",
        color: "from-green-500 to-teal-500",
        words: [
          { word: "Obtain", thai: "‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö/‡πÑ‡∏î‡πâ‡∏°‡∏≤", example: "The local authority may assist you to obtain alternative accommodation.", exampleThai: "‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å" },
          { word: "Maintain", thai: "‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤", example: "The company must maintain high standards of quality.", exampleThai: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏™‡∏°‡∏≠" },
          { word: "Propose", thai: "‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠", example: "The manager will propose a new marketing strategy.", exampleThai: "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÉ‡∏´‡∏°‡πà" },
          { word: "Ensure", thai: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à", example: "Please ensure that all lights are turned off.", exampleThai: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏ó‡∏∏‡∏Å‡∏î‡∏ß‡∏á‡πÅ‡∏•‡πâ‡∏ß" }
        ]
      },
      "day6-7": {
        title: "Day 6-7: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ -ate, -ble, -ize, -ment, -ty, -ive",
        emoji: "üìà",
        color: "from-pink-500 to-rose-500",
        words: [
          { word: "Participate", thai: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°", example: "Everyone who wishes to participate in the seminar must register.", exampleThai: "‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô" },
          { word: "Available", thai: "‡∏ß‡πà‡∏≤‡∏á/‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà", example: "The information will be available online.", exampleThai: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå" },
          { word: "Analyze", thai: "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", example: "The research team will analyze the data.", exampleThai: "‡∏ó‡∏µ‡∏°‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏à‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" },
          { word: "Achievement", thai: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", example: "Her recent promotion was a significant achievement.", exampleThai: "‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç" },
          { word: "Productivity", thai: "‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û", example: "The team's productivity improved significantly.", exampleThai: "‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î" }
        ]
      },
      "day8-9": {
        title: "Day 8-9: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ -ure ‡πÅ‡∏•‡∏∞ -ent",
        emoji: "‚ö°",
        color: "from-indigo-500 to-purple-500",
        words: [
          { word: "Procedure", thai: "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô", example: "The company implemented a new procedure for reporting hazards.", exampleThai: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÉ‡∏ä‡πâ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢" },
          { word: "Apparent", thai: "‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô", example: "It was apparent that the new policy was not well received.", exampleThai: "‡∏°‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡∏ß‡πà‡∏≤‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏î‡∏µ" },
          { word: "Efficient", thai: "‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û", example: "Our goal is to create an efficient system.", exampleThai: "‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û" }
        ]
      },
      "day10": {
        title: "Day 10: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏ï‡∏¥‡∏° -ed",
        emoji: "üèÜ",
        color: "from-amber-500 to-yellow-500",
        words: [
          { word: "Limited", thai: "‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î", example: "The offer was limited to the first 100 customers.", exampleThai: "‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ô‡∏µ‡πâ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 100 ‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å" },
          { word: "Directed to", thai: "‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏´‡∏≤", example: "All inquiries must be directed to the manager.", exampleThai: "‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£" },
          { word: "Committed to", thai: "‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞", example: "The company is committed to providing excellent service.", exampleThai: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°" }
        ]
      }
    };

    // State
    let currentView = 'home';
    let currentDay = null;
    let quizQuestions = [];
    let currentQuestionIndex = 0;
    let quizScore = 0;
    let selectedDays = ['day1-2', 'day3', 'day4', 'day5', 'day6-7', 'day8-9', 'day10'];
    let quizCount = 10;
    let userProgress = [];
    let totalCorrect = 0;

    // Default config
    const defaultConfig = {
      app_title: "üìö TOEIC Vocabulary Master",
      background_color: "#1a1a2e",
      surface_color: "#16213e",
      text_color: "#ffffff",
      primary_action_color: "#e94560",
      secondary_action_color: "#00d9ff"
    };

    // Text-to-Speech function
    function speak(text) {
      if ('speechSynthesis' in window) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = 0.8;
        utterance.pitch = 1;
        window.speechSynthesis.speak(utterance);
      }
    }

    // Data handler for SDK
    const dataHandler = {
      onDataChanged(data) {
        userProgress = data;
        updateStats();
        updateStreakDisplay();
      }
    };

    // Initialize SDKs
    async function initApp() {
      // Initialize Element SDK
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            const titleEl = document.getElementById('main-title');
            if (titleEl) {
              titleEl.textContent = config.app_title || defaultConfig.app_title;
            }
            document.body.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, ${config.surface_color || defaultConfig.surface_color} 100%)`;
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (v) => { config.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
              },
              {
                get: () => config.surface_color || defaultConfig.surface_color,
                set: (v) => { config.surface_color = v; window.elementSdk.setConfig({ surface_color: v }); }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (v) => { config.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
              },
              {
                get: () => config.primary_action_color || defaultConfig.primary_action_color,
                set: (v) => { config.primary_action_color = v; window.elementSdk.setConfig({ primary_action_color: v }); }
              },
              {
                get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                set: (v) => { config.secondary_action_color = v; window.elementSdk.setConfig({ secondary_action_color: v }); }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ["app_title", config.app_title || defaultConfig.app_title]
          ])
        });
      }

      // Initialize Data SDK
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          console.error("Failed to initialize data SDK");
        }
      }

      renderDaysGrid();
      renderQuizDaySelection();
    }

    // Render days grid on home
    function renderDaysGrid() {
      const grid = document.getElementById('days-grid');
      grid.innerHTML = '';
      
      Object.entries(vocabularyData).forEach(([dayId, day], index) => {
        const card = document.createElement('div');
        card.className = `day-card card-glass rounded-2xl p-6 cursor-pointer transition-all duration-300 animate-slide`;
        card.style.animationDelay = `${index * 0.1}s`;
        card.onclick = () => openDay(dayId);
        
        const wordCount = day.words.length;
        const masteredCount = userProgress.filter(p => 
          day.words.some(w => w.word === p.word_id) && p.correct_count > p.wrong_count
        ).length;
        
        card.innerHTML = `
          <div class="text-4xl mb-3">${day.emoji}</div>
          <h3 class="font-bold text-lg mb-2 bg-gradient-to-r ${day.color} bg-clip-text text-transparent">${day.title.split(':')[0]}</h3>
          <p class="text-sm text-gray-400 mb-3">${day.title.split(':')[1] || ''}</p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500">${wordCount} ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</span>
            <span class="text-xs px-2 py-1 rounded-full bg-green-500/20 text-green-400">${masteredCount}/${wordCount} ‚úì</span>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // Open day for learning
    function openDay(dayId) {
      currentDay = dayId;
      const day = vocabularyData[dayId];
      document.getElementById('learn-title').textContent = day.title;
      renderWordsList(day.words);
      showView('learn');
    }

    // Render words list
    function renderWordsList(words) {
      const list = document.getElementById('words-list');
      list.innerHTML = '';
      
      words.forEach((word, index) => {
        const progress = userProgress.find(p => p.word_id === word.word);
        const mastered = progress && progress.correct_count > progress.wrong_count;
        
        const card = document.createElement('div');
        card.className = `word-card card-glass rounded-2xl p-5 border-2 border-transparent transition-all animate-slide`;
        card.style.animationDelay = `${index * 0.05}s`;
        
        card.innerHTML = `
          <div class="flex items-start justify-between mb-3">
            <div class="flex items-center gap-3">
              <button onclick="speak('${word.word}')" class="speaker-btn text-2xl hover:scale-110 transition-transform" title="‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á">
                üîä
              </button>
              <div>
                <h4 class="text-xl font-bold text-white">${word.word}</h4>
                <p class="text-pink-400 font-medium">${word.thai}</p>
              </div>
            </div>
            ${mastered ? '<span class="text-green-400 text-xl">‚úì</span>' : ''}
          </div>
          <div class="bg-white/5 rounded-xl p-4">
            <p class="text-gray-300 mb-2">"${word.example}"</p>
            <p class="text-sm text-gray-500">${word.exampleThai}</p>
          </div>
          <button onclick="speak('${word.example}')" class="mt-3 text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1">
            üîà ‡∏ü‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
          </button>
        `;
        list.appendChild(card);
      });
    }

    // Render quiz day selection
    function renderQuizDaySelection() {
      const container = document.getElementById('quiz-day-selection');
      container.innerHTML = '';
      
      const allBtn = document.createElement('button');
      allBtn.className = 'px-3 py-1 rounded-lg text-sm transition-all bg-pink-500/20 border border-pink-500';
      allBtn.textContent = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
      allBtn.onclick = () => toggleAllDays();
      container.appendChild(allBtn);
      
      Object.entries(vocabularyData).forEach(([dayId, day]) => {
        const btn = document.createElement('button');
        btn.className = `day-select-btn px-3 py-1 rounded-lg text-sm transition-all ${selectedDays.includes(dayId) ? 'bg-pink-500/20 border border-pink-500' : 'bg-white/10 border border-white/20'}`;
        btn.dataset.day = dayId;
        btn.textContent = day.title.split(':')[0];
        btn.onclick = () => toggleDay(dayId);
        container.appendChild(btn);
      });
    }

    function toggleDay(dayId) {
      const index = selectedDays.indexOf(dayId);
      if (index > -1) {
        if (selectedDays.length > 1) {
          selectedDays.splice(index, 1);
        }
      } else {
        selectedDays.push(dayId);
      }
      updateDaySelectionUI();
    }

    function toggleAllDays() {
      if (selectedDays.length === Object.keys(vocabularyData).length) {
        selectedDays = ['day1-2'];
      } else {
        selectedDays = Object.keys(vocabularyData);
      }
      updateDaySelectionUI();
    }

    function updateDaySelectionUI() {
      document.querySelectorAll('.day-select-btn').forEach(btn => {
        const dayId = btn.dataset.day;
        if (selectedDays.includes(dayId)) {
          btn.className = 'day-select-btn px-3 py-1 rounded-lg text-sm transition-all bg-pink-500/20 border border-pink-500';
        } else {
          btn.className = 'day-select-btn px-3 py-1 rounded-lg text-sm transition-all bg-white/10 border border-white/20';
        }
      });
    }

    function setQuizCount(count) {
      quizCount = count;
      document.querySelectorAll('.quiz-count-btn').forEach(btn => {
        btn.className = 'quiz-count-btn px-4 py-2 rounded-lg ' + 
          (btn.textContent.includes(count) || (count === 30 && btn.textContent.includes('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')) 
            ? 'bg-pink-500/20 border border-pink-500' 
            : 'bg-white/10 border border-white/20');
      });
    }

    // Generate TOEIC-style questions
    function generateQuestions() {
      const allWords = [];
      selectedDays.forEach(dayId => {
        allWords.push(...vocabularyData[dayId].words);
      });
      
      // Shuffle words
      const shuffled = allWords.sort(() => Math.random() - 0.5);
      const questionWords = shuffled.slice(0, Math.min(quizCount, shuffled.length));
      
      return questionWords.map(word => {
        const questionType = Math.random() > 0.5 ? 'fill-blank' : 'meaning';
        
        if (questionType === 'fill-blank') {
          // Fill in the blank question
          const sentence = word.example.replace(new RegExp(word.word, 'gi'), '_______');
          const wrongOptions = allWords
            .filter(w => w.word !== word.word)
            .sort(() => Math.random() - 0.5)
            .slice(0, 3)
            .map(w => w.word);
          
          const options = [...wrongOptions, word.word].sort(() => Math.random() - 0.5);
          
          return {
            type: 'fill-blank',
            question: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á:',
            sentence: sentence,
            options: options,
            correct: word.word,
            meaning: `${word.word} = ${word.thai}`,
            fullWord: word
          };
        } else {
          // Meaning question
          const wrongOptions = allWords
            .filter(w => w.word !== word.word)
            .sort(() => Math.random() - 0.5)
            .slice(0, 3)
            .map(w => w.thai);
          
          const options = [...wrongOptions, word.thai].sort(() => Math.random() - 0.5);
          
          return {
            type: 'meaning',
            question: `"${word.word}" ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏≠‡∏∞‡πÑ‡∏£?`,
            sentence: word.example,
            options: options,
            correct: word.thai,
            meaning: `${word.word} = ${word.thai}`,
            fullWord: word
          };
        }
      });
    }

    // Start quiz
    function startQuiz() {
      quizQuestions = generateQuestions();
      currentQuestionIndex = 0;
      quizScore = 0;
      
      document.getElementById('quiz-setup').classList.add('hidden');
      document.getElementById('quiz-progress').classList.remove('hidden');
      document.getElementById('quiz-result').classList.add('hidden');
      
      showQuestion();
    }

    // Show current question
    function showQuestion() {
      const question = quizQuestions[currentQuestionIndex];
      
      document.getElementById('quiz-counter').textContent = `‡∏Ç‡πâ‡∏≠ ${currentQuestionIndex + 1}/${quizQuestions.length}`;
      document.getElementById('quiz-score').textContent = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${quizScore}`;
      document.getElementById('quiz-progress-bar').style.width = `${(currentQuestionIndex / quizQuestions.length) * 100}%`;
      
      document.getElementById('quiz-question').querySelector('p').textContent = question.question;
      document.getElementById('quiz-sentence').textContent = question.sentence;
      
      const optionsContainer = document.getElementById('quiz-options');
      optionsContainer.innerHTML = '';
      
      question.options.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn p-4 rounded-xl text-left border-2 border-white/20 bg-white/5 transition-all';
        btn.innerHTML = `<span class="text-gray-400 mr-2">${String.fromCharCode(65 + index)}.</span> ${option}`;
        btn.onclick = () => selectAnswer(option, btn);
        optionsContainer.appendChild(btn);
      });
      
      document.getElementById('quiz-feedback').classList.add('hidden');
      document.getElementById('next-question-btn').classList.add('hidden');
    }

    // Select answer
    async function selectAnswer(answer, btnElement) {
      const question = quizQuestions[currentQuestionIndex];
      const isCorrect = answer === question.correct;
      
      // Disable all buttons
      document.querySelectorAll('.option-btn').forEach(btn => {
        btn.disabled = true;
        if (btn.textContent.includes(question.correct)) {
          btn.classList.add('correct');
        }
      });
      
      if (isCorrect) {
        btnElement.classList.add('correct');
        quizScore++;
        totalCorrect++;
        document.getElementById('quiz-score').textContent = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${quizScore}`;
      } else {
        btnElement.classList.add('wrong');
      }
      
      // Show feedback
      const feedback = document.getElementById('quiz-feedback');
      feedback.classList.remove('hidden');
      feedback.className = `p-4 rounded-xl mb-4 ${isCorrect ? 'bg-green-500/20' : 'bg-red-500/20'}`;
      document.getElementById('feedback-text').textContent = isCorrect ? '‚úì ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!' : '‚úó ‡∏ú‡∏¥‡∏î';
      document.getElementById('feedback-meaning').textContent = question.meaning;
      
      // Speak the word
      speak(question.fullWord.word);
      
      // Save progress
      await saveProgress(question.fullWord.word, isCorrect);
      
      document.getElementById('next-question-btn').classList.remove('hidden');
      updateStreakDisplay();
    }

    // Save progress to Data SDK
    async function saveProgress(wordId, isCorrect) {
      if (!window.dataSdk) return;
      
      const existing = userProgress.find(p => p.word_id === wordId);
      
      if (existing) {
        const updated = {
          ...existing,
          correct_count: isCorrect ? existing.correct_count + 1 : existing.correct_count,
          wrong_count: isCorrect ? existing.wrong_count : existing.wrong_count + 1,
          last_practiced: new Date().toISOString()
        };
        await window.dataSdk.update(updated);
      } else {
        if (userProgress.length >= 999) {
          console.warn('Data limit reached');
          return;
        }
        await window.dataSdk.create({
          word_id: wordId,
          correct_count: isCorrect ? 1 : 0,
          wrong_count: isCorrect ? 0 : 1,
          last_practiced: new Date().toISOString()
        });
      }
    }

    // Next question
    function nextQuestion() {
      currentQuestionIndex++;
      if (currentQuestionIndex < quizQuestions.length) {
        showQuestion();
      } else {
        showResult();
      }
    }

    // Show result
    function showResult() {
      document.getElementById('quiz-progress').classList.add('hidden');
      document.getElementById('quiz-result').classList.remove('hidden');
      
      const percentage = Math.round((quizScore / quizQuestions.length) * 100);
      document.getElementById('result-score').textContent = `${quizScore}/${quizQuestions.length}`;
      document.getElementById('result-percentage').textContent = `‡∏ó‡∏≥‡πÑ‡∏î‡πâ ${percentage}%`;
    }

    // Reset quiz
    function resetQuiz() {
      document.getElementById('quiz-setup').classList.remove('hidden');
      document.getElementById('quiz-progress').classList.add('hidden');
      document.getElementById('quiz-result').classList.add('hidden');
    }

    // Update stats view
    function updateStats() {
      const totalCorrectCount = userProgress.reduce((sum, p) => sum + p.correct_count, 0);
      const totalWrongCount = userProgress.reduce((sum, p) => sum + p.wrong_count, 0);
      const total = totalCorrectCount + totalWrongCount;
      const accuracy = total > 0 ? Math.round((totalCorrectCount / total) * 100) : 0;
      
      document.getElementById('stat-correct').textContent = totalCorrectCount;
      document.getElementById('stat-wrong').textContent = totalWrongCount;
      document.getElementById('stat-total').textContent = userProgress.length;
      document.getElementById('stat-accuracy').textContent = `${accuracy}%`;
      
      // Show weak words
      const weakWords = userProgress
        .filter(p => p.wrong_count > p.correct_count)
        .sort((a, b) => (b.wrong_count - b.correct_count) - (a.wrong_count - a.correct_count))
        .slice(0, 5);
      
      const weakWordsContainer = document.getElementById('weak-words');
      if (weakWords.length > 0) {
        weakWordsContainer.innerHTML = weakWords.map(p => {
          const wordData = findWordData(p.word_id);
          return `
            <div class="card-glass rounded-xl p-3 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <button onclick="speak('${p.word_id}')" class="speaker-btn">üîä</button>
                <div>
                  <span class="font-medium">${p.word_id}</span>
                  <span class="text-sm text-gray-400 ml-2">${wordData ? wordData.thai : ''}</span>
                </div>
              </div>
              <span class="text-red-400 text-sm">${p.wrong_count} ‡∏ú‡∏¥‡∏î / ${p.correct_count} ‡∏ñ‡∏π‡∏Å</span>
            </div>
          `;
        }).join('');
      } else {
        weakWordsContainer.innerHTML = '<p class="text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡∏π‡∏ô‡∏∞!</p>';
      }
      
      renderDaysGrid();
    }

    // Find word data by word
    function findWordData(wordId) {
      for (const day of Object.values(vocabularyData)) {
        const word = day.words.find(w => w.word === wordId);
        if (word) return word;
      }
      return null;
    }

    // Update streak display
    function updateStreakDisplay() {
      const totalCorrectCount = userProgress.reduce((sum, p) => sum + p.correct_count, 0);
      document.getElementById('streak-display').textContent = `üî• ${totalCorrectCount} ‡∏Ñ‡∏≥‡∏ñ‡∏π‡∏Å`;
    }

    // Show view
    function showView(view) {
      currentView = view;
      
      document.getElementById('home-view').classList.add('hidden');
      document.getElementById('learn-view').classList.add('hidden');
      document.getElementById('quiz-view').classList.add('hidden');
      document.getElementById('stats-view').classList.add('hidden');
      
      document.getElementById(`${view}-view`).classList.remove('hidden');
      document.getElementById(`${view}-view`).classList.add('animate-fade');
      
      // Update nav tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        if (tab.dataset.view === view) {
          tab.className = 'nav-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all bg-pink-500/20 border border-pink-500/50';
        } else {
          tab.className = 'nav-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all bg-white/10 border border-white/20';
        }
      });
      
      if (view === 'stats') {
        updateStats();
      }
      
      if (view === 'learn' && !currentDay) {
        openDay('day1-2');
      }
    }

    // Initialize app
    initApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d2fdeade345e60e',t:'MTc3MTk0NTYxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
